

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mutable matrices: LLSparseMatrix and LLSparseMatrixView &mdash; CySparse: A sparse matrix library for Python/Cython.</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/julia.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="CySparse: A sparse matrix library for Python/Cython." href="index.html"/>
        <link rel="next" title="Imutable matrices: CSR-, CSC- and CSBSparseMatrix" href="immutable_mat.html"/>
        <link rel="prev" title="CySparse‘s types" href="types.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="contents.html" class="icon icon-home"> CySparse: A sparse matrix library for Python/Cython.
          

          
          </a>
          <h1>CySparse: A sparse matrix library for Python/Cython.</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul>
<li><a class="reference internal" href="#">Mutable matrices: <code class="docutils literal"><span class="pre">LLSparseMatrix</span></code> and <code class="docutils literal"><span class="pre">LLSparseMatrixView</span></code></a><ul>
<li><a class="reference internal" href="#the-llsparsematrix-class">The <code class="docutils literal"><span class="pre">LLSparseMatrix</span></code> class</a><ul>
<li><a class="reference internal" href="#creation">Creation</a></li>
<li><a class="reference internal" href="#population">Population</a></li>
<li><a class="reference internal" href="#accessing-elements">Accessing elements</a><ul>
<li><a class="reference internal" href="#individual-access">Individual access</a></li>
<li><a class="reference internal" href="#batch-access">Batch access</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-llsparsematrixview-class">The <code class="docutils literal"><span class="pre">LLSparseMatrixView</span></code> class</a><ul>
<li><a class="reference internal" href="#views-of-views">Views of views</a></li>
<li><a class="reference internal" href="#references-to-the-base-llsparsematrix">References to the base <code class="docutils literal"><span class="pre">LLSparseMatrix</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">CySparse: A sparse matrix library for Python/Cython.</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="contents.html">Docs</a> &raquo;</li>
        
      <li>Mutable matrices: <code class="docutils literal"><span class="pre">LLSparseMatrix</span></code> and <code class="docutils literal"><span class="pre">LLSparseMatrixView</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/PythonOptimizers/cysparse/blob/master/doc/source/mutable_ll_mat.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mutable-matrices-llsparsematrix-and-llsparsematrixview">
<span id="mutable-ll-mat"></span><h1>Mutable matrices: <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code> and <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code><a class="headerlink" href="#mutable-matrices-llsparsematrix-and-llsparsematrixview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-llsparsematrix-class">
<h2>The <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code> class<a class="headerlink" href="#the-llsparsematrix-class" title="Permalink to this headline">¶</a></h2>
<p>The <em>mutable</em> <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code> class is the base class to <strong>construct</strong> and <strong>populate</strong> a matrix. With it you can easily add or delete elements, rows, columns, assign sub-matrices, etc. Once your matrix is constructed,
you create a new <em>optimized</em> and <em>immutable</em> matrix from it. You can choose between CSR, CSC and CSB. Each has its strength and weaknesses and we cover them in depth in their respective sections.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <code class="docutils literal"><span class="pre">LLSparseMatrix</span></code> class is <strong>not</strong> optimized for matrix operations!</p>
</div>
<div class="section" id="creation">
<h3>Creation<a class="headerlink" href="#creation" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="population">
<h3>Population<a class="headerlink" href="#population" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="accessing-elements">
<h3>Accessing elements<a class="headerlink" href="#accessing-elements" title="Permalink to this headline">¶</a></h3>
<p>Elements can be accessed individually or by batch, i.e. several elements can be accessed at the same time and stored in a container.</p>
<div class="section" id="individual-access">
<h4>Individual access<a class="headerlink" href="#individual-access" title="Permalink to this headline">¶</a></h4>
<p>You can use the common <code class="docutils literal"><span class="pre">[]</span></code> operator:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">NewLLSparseMatrix</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> are integer indices. At all time, bounds are checked and an <code class="docutils literal"><span class="pre">IndexError</span></code> is raised if an index is out of bound. <strong class="program">Cython</strong> users can access the elements <strong>whithout</strong> bound checking if desired.</p>
<p>Notice that if one of the argument you pass to the <code class="docutils literal"><span class="pre">[]</span></code> operator is <strong>not</strong> an integer, you&#8217;ll get an <code class="docutils literal"><span class="pre">LLSparseMatrixView</span></code> (see <a class="reference internal" href="#ll-sparse-matrix-view"><span class="std std-ref">The LLSparseMatrixView class</span></a>).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If one of the argument you pass to the <code class="docutils literal"><span class="pre">[]</span></code> operator is <strong>not</strong> an integer, you&#8217;ll get an <code class="docutils literal"><span class="pre">LLSparseMatrixView</span></code></p>
</div>
</div>
<div class="section" id="batch-access">
<h4>Batch access<a class="headerlink" href="#batch-access" title="Permalink to this headline">¶</a></h4>
<p>Basically, you can take a submatrix (and store its elements in a <code class="docutils literal"><span class="pre">NumPy</span></code> two dimensionnal array or another <code class="docutils literal"><span class="pre">LLSparseMatrix</span></code> or get a view to it, see <a class="reference internal" href="#ll-sparse-matrix-view"><span class="std std-ref">The LLSparseMatrixView class</span></a> ) or a list of elements</p>
</div>
</div>
</div>
<div class="section" id="the-llsparsematrixview-class">
<span id="ll-sparse-matrix-view"></span><h2>The <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code> class<a class="headerlink" href="#the-llsparsematrixview-class" title="Permalink to this headline">¶</a></h2>
<div class="topic">
<p class="topic-title first">What is an <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code> good for?</p>
<p>There are basically two reasons to use a view instead of a matrix:</p>
<ul class="simple">
<li>efficiency: no matrix_copy is made and the <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code> is a light object. TO BE COMPLETED</li>
<li>really fancy indexing: if you need a new matrix constructed by <strong>any</strong> combinations of rows and columns, including
index repetitions. TO BE COMPLETED.</li>
</ul>
</div>
<div class="section" id="views-of-views">
<h3>Views of views<a class="headerlink" href="#views-of-views" title="Permalink to this headline">¶</a></h3>
<p>It is possible to have views of... views as the following code illustrates:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">MakeLLSparseMatrix</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">A_view1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">A_view2</span> <span class="o">=</span> <span class="n">A_view1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>The second <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code> is <strong>not</strong> a view on a view but a direct view on the original matrix <code class="docutils literal"><span class="pre">A</span></code>. The only difference between the two objects <code class="docutils literal"><span class="pre">A_view1</span></code> and <code class="docutils literal"><span class="pre">A_view2</span></code> is that
the indices given in the <code class="docutils literal"><span class="pre">[...,</span> <span class="pre">...]</span></code> in <code class="docutils literal"><span class="pre">A_view1[...,</span> <span class="pre">...]</span></code> refer to indices of <code class="docutils literal"><span class="pre">A_view1</span></code> <strong>not</strong> the original matrix <code class="docutils literal"><span class="pre">A</span></code>.</p>
<p>An example will clarify this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="references-to-the-base-llsparsematrix">
<h3>References to the base <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code><a class="headerlink" href="#references-to-the-base-llsparsematrix" title="Permalink to this headline">¶</a></h3>
<p>Whenever a <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code> is created, the corresponding <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code> has its
internal CPython reference count incremented such that even if the matrix object is (implicitely of explicitely) deleted, it still
exist in Python internal memory and can even be retrieved again through the view:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">MakeLLSparseMatrix</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">A_view</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

<span class="k">del</span> <span class="n">A</span>

<span class="n">A_view</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># still works!</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">A_view</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">()</span> <span class="c1"># A points again to the original matrix</span>
</pre></div>
</div>
<p>In the code above, the <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code> pointed by the variable <code class="docutils literal"><span class="pre">A</span></code> on the first line has never been
deleted from memory. If you also delete <strong>all</strong> <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrixView</span></code> objects refering to the <code class="xref py py-class docutils literal"><span class="pre">LLSparseMatrix</span></code> object,
then it is effictively deleted by the garbage collector.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">MakeLLSparseMatrix</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">A_view</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

<span class="k">del</span> <span class="n">A</span>
<span class="k">del</span> <span class="n">A_view</span>

<span class="c1"># matrix A is lost... and will be deleted by the garbage collector</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="immutable_mat.html" class="btn btn-neutral float-right" title="Imutable matrices: CSR-, CSC- and CSBSparseMatrix" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="types.html" class="btn btn-neutral" title="CySparse‘s types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Dominique Orban, Sylvain Arreckx and Nikolaj van Omme.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>